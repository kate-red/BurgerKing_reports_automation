# **Автоматизация предобработки данных из Excel и CSV файлов для составления еженедельных и ежедневных отчетов о текущих HR-показателях в компании Burger King**

**1. ORIS -**  предобработка отчетности, скаченной с сайта партнерской медецинской организации. 
В двух отчетах с этого ресурса (отчет по Москве и МО и региональный отчет) содержатся данные о прохождении мед. осмотра на текущей неделе. Файлы скачиваются в формате SCV. Из этого отчет важно понять, сколько новых сотрудников за прошедшую неделю были направлены на мед. осмотр, а сколько его успешно прошли.

*Для обработки этих отчетов был создан класс OrisReport, и ряд функций, обрабатывающих данные:*
- Класс принимает на вход 2 аргумента: путь до файла с отчетом по ММО и путь до файла с региональным отчетом;
- Функция merge_tables склеивает региональный и московский отчет в одну таблицу;
- Функция get_week возвращает список дат предыдущей недели
- Функция oris_filter фильтрует и преобразует данные в итоговую таблицу нужного вида;
- Функция save_excel_file сохраняет полученную отфильтрованную таблицу в Excel файл на лист "Данные", а сводная таблица, сгруппированная по номеру рестарана, добавляется на лист "Сводная".

**2. Completeness report -** предобработка отчета по комплектности сотрудников.
Отчет по комплектности сотрудников приходит по всем должностям. Необходимо отобрать только те данные, которые относятся к массовому подбору. Для этой цели был создан класс CompletenessReport, его функции:
        
- Функция get_file - загружает файл из Excel;
- Функция data_filter - фильтрует данные, оставляя только колонки, относящиеся к масс подбору. Суммирует плановые и фактические часы, формирует итоговую таблицу;
- Функция save_to_excel - сохраняет данные в Excel.


**3. daily_report и daily_applications_for_selection** - создание ежедневного отчета по направленным от Отдела Подбора.
- Функция add_zero добавляет нули для корректного отображения кода ресторана в четырехзначном формате: "0ХХХ";
- Предобработка информации для корректного отображения дивизионов и должностей;
- Графики plotly для визуализации данных о направленных.

**4. OP_report и OP_report_statuses** - создание еженедельного отчета по направленным от Отдела Подбора.
- Функция get_right_date_format - преобразует формат даты, если даты были записаны с ошибками;
- Функция fix_telephone - преобразует формат телефона в единый формат: +7(ХХХ)-ХХХ-ХХ-ХХ. Если телефон написан с ошибкой, в графе появляется пометка об этом
- Класс ReportFromOP предназначен для обработки еженедельного отчета HR департамента по направленным на собеседование кандидатам op_rep_path, div_lst_path - путь до файловб .with_divs - отчет по направленным с добавлением индикатора о регионе и дивизионе, а так же с корректными датами и форматами телефонов .pivot - сводная таблица по отчету, с с добавлением новых столбцов и доп. фильтров
- Класс DivisionReport разделяет отчет по направленным, оставляя только данные, отноящиеся к тому или иному дивизиону, division_name - название дивизиона ("Евразия" / "ММО" / "Центральная Россия")
- Функция add_status_columns проставляет статусы для направленных кандидатов на основе информации, заполненной рекруторами
